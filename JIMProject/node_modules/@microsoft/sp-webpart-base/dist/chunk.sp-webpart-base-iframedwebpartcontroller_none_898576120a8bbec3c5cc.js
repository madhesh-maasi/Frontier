(window.webpackJsonp_974a7777_0990_4136_8fa6_95d80114c2e0_1_14_0=window.webpackJsonp_974a7777_0990_4136_8fa6_95d80114c2e0_1_14_0||[]).push([[1],{CL8W:function(e,t,n){"use strict";n.r(t);var a=n("UWqr"),i=n("ut3N"),r=n("vlQI"),o=n("I6O9"),s=n("Pk8u"),c=n("7Awa"),d=n("w4+A"),l=n("+ORw"),u=n("7vVn");n("jOlS").loadStyles('.a_a_7caff1a1{top:0;width:340px;position:relative;z-index:999;transition:width 367ms cubic-bezier(.1,.9,.2,1);-webkit-transition:width 367ms cubic-bezier(.1,.9,.2,1)}[id^=spIFramePropertyPaneContainer].b_a_7caff1a1{bottom:0;background-color:"[theme:bodyBackground, default: #ffffff]"}[dir=ltr] [id^=spIFramePropertyPaneContainer].b_a_7caff1a1{right:0}[dir=rtl] [id^=spIFramePropertyPaneContainer].b_a_7caff1a1{left:0}[dir=ltr] [id^=spIFramePropertyPaneContainer].b_a_7caff1a1{border-left-width:1px}[dir=rtl] [id^=spIFramePropertyPaneContainer].b_a_7caff1a1{border-right-width:1px}[dir=ltr] [id^=spIFramePropertyPaneContainer].b_a_7caff1a1{border-left-style:solid}[dir=rtl] [id^=spIFramePropertyPaneContainer].b_a_7caff1a1{border-right-style:solid}[dir=ltr] [id^=spIFramePropertyPaneContainer].b_a_7caff1a1{border-left-color:"[theme:neutralLight, default: #edebe9]"}[dir=rtl] [id^=spIFramePropertyPaneContainer].b_a_7caff1a1{border-right-color:"[theme:neutralLight, default: #edebe9]"}[id^=spIFramePropertyPaneContainer].b_a_7caff1a1 button{display:block}[id^=spIFramePropertyPaneContainer].c_a_7caff1a1{width:0;transition:width 367ms cubic-bezier(.1,.9,.2,1);-webkit-transition:width 367ms cubic-bezier(.1,.9,.2,1)}[dir=ltr] [id^=spPageChromeAppDiv].e_a_7caff1a1{right:340px}[dir=rtl] [id^=spPageChromeAppDiv].e_a_7caff1a1{left:340px}.f_a_7caff1a1{width:100%;height:100%;height:-webkit-fill;height:-moz-fill;border:0}.g_a_7caff1a1{width:100%;height:100%;float:left;border:none}',!0);var f,p="b_a_7caff1a1",m="c_a_7caff1a1",_="e_a_7caff1a1";!function(e){e.List="list",e.Id="id",e.WebPartInstanceId="webPartInstanceId",e.NewWebPartInstanceId="newWebPartInstanceId",e.ParentWindowOrigin="parentWindowOrigin",e.ComponentId="componentId",e.HostedInCanvas="hostedInCanvas",e.HostedInTeams="hostedInTeams",e.OpenPropertyPane="openPropertyPane",e.OpenDetailsPropertyPane="openDetailsPropertyPane"}(f||(f={}));var h=i._LogSource.create("IframedWebPartController"),b="dom-isolated-property-pane",g=function(){function e(e,t,n){this._controller=e,this.origin=n.origin,this.url=n.url,this.webPartData=n.webPartData,this.webPartElementId=n.webPartElementId,this.displayMode=n.displayMode,this.addedFromPersistedData=n.addedFromPersistedData,this.theme=n.theme,this.instanceId=n.webPartData.instanceId,this.isDisposed=!1,this._themeProvider=t.consume(c.ThemeProvider.serviceKey),this._onThemeChanged.bind(this),Object(l.h)()||this._themeProvider.themeChangedEvent.add(this,this._onThemeChanged)}return Object.defineProperty(e.prototype,"componentId",{get:function(){return this.webPartElementId},enumerable:!1,configurable:!0}),e.prototype.dispose=function(){Object(l.h)()||this._themeProvider.themeChangedEvent.remove(this,this._onThemeChanged),this.isDisposed=!0},e.prototype._onThemeChanged=function(e){e.theme&&this._controller.setTheme(e.theme,this.instanceId)},e}(),v=function(){function e(e){this._iframeSrcUrl=void 0,this._iframedWebparts=new Map,this._host=e,this._ppIframeElement=void 0,this._iframeContextMap=new Map,this._updateWebPartData=this._updateWebPartData.bind(this),this._updateWebPartDisplayMode=this._updateWebPartDisplayMode.bind(this),this._iframeEventListener=this._iframeEventListener.bind(this),window.addEventListener("message",this._iframeEventListener)}return e.prototype.deleteWebPart=function(e){Object(l.u)()||this._iframeContextMap.delete(e),a.Validate.isNonemptyString(e,"instanceId");var t=this._iframedWebparts.get(e),n=document.getElementById(b);if(n&&n.contentWindow){var i={instanceId:e,action:u.e.DeleteWebPart};n.contentWindow.postMessage(i,t.url)}this.requestPropertyPaneAction("Close"),t.dispose(),this._iframedWebparts.delete(e)},e.prototype.getAllInstanceIds=function(){var e=[];return this._iframedWebparts.forEach(function(t,n){e.push(n)}),e},e.prototype.notifyContainerResize=function(e){},e.prototype.startDirtyBitTimer=function(e){},e.prototype.loadWebPart=function(e,t,n){Object(l.u)()||this._iframeContextMap.set(n.instanceId,n),this._iframeSrcUrl=this._generateIframeSrcUrl(e,t,n),a.Validate.isNotNullOrUndefined(n.webPartData,"webPartData");var i={origin:e,url:this._iframeSrcUrl,webPartData:n.webPartData,webPartElementId:"dom-isolated-webpart-"+n.instanceId,displayMode:n.displayMode,addedFromPersistedData:!!n.addedFromPersistedData,theme:Object(l.h)()?this._tryGetTheme(n.instanceId):void 0};if(this._iframedWebparts.has(n.instanceId)||(n.addedFromPersistedData||(i.webPartData.dataVersion="1.0",i.webPartData.instanceId=n.instanceId),this._iframedWebparts.set(n.instanceId,new g(this,n.serviceScope||this._host.serviceScope,i))),o._SPLoaderFlights._isSafariIsolationEnabled()){var r=document.createElement("iframe");r.id=i.webPartElementId,r.src=this._addFilteredQueryParamsFromHostPage(i.url),r.classList.add("f_a_7caff1a1"),r.scrolling="no",r.onload=function(){return o._IframeLoadRedirector.instance.confirmLoadOrRedirect(r.src)},Object(l.f)()||(r.tabIndex=0);var s=document.createElement("div");s.appendChild(r),n.domElement.appendChild(s)}else n.domElement.innerHTML="<div>\n        <iframe\n          id="+i.webPartElementId+"\n          src="+this._addFilteredQueryParamsFromHostPage(i.url)+'\n          class=f_a_7caff1a1\n          scrolling="no"\n          '+(Object(l.f)()?"":'tabindex="0"')+"\n        ></iframe>\n      </div>"},e.prototype.requestPropertyPaneAction=function(e,t){switch(a.Validate.isNotNullOrUndefined(e,"propertyPaneState"),e){case"Open":case"OpenDetails":a.Validate.isNonemptyString(t,"instanceId"),this._ppIframeElement||this._createPropertyPaneElement(t,!Object(l._)()&&"OpenDetails"===e),this._showPropertyPane(t,e);break;case"Close":this._ppIframeElement&&this._hidePropertyPane(t);break;case"Toggle":a.Validate.isNonemptyString(t,"instanceId"),this._iframedPropertyPaneContainer&&this._iframedPropertyPaneContainer.classList.contains(p)?this._hidePropertyPane(t):(this._iframedPropertyPaneContainer||this._createPropertyPaneElement(t),this._showPropertyPane(t,"Open"));break;case"Refresh":a.Validate.isNonemptyString(t,"instanceId"),this._refreshPropertyPane(t)}},e.prototype.serialize=function(e){return a.Validate.isNonemptyString(e,"instanceId"),this._iframedWebparts.get(e).webPartData},e.prototype.setDisplayMode=function(e,t){a.Validate.isNotNullOrUndefined(e,"displayMode"),a.Validate.isNonemptyString(t,"instanceId");var n={instanceId:t,action:u.e.SetDisplayMode,displayMode:e},i=this._iframedWebparts.get(t);i.displayMode=e;var r=this._getCurrentIframeWebPartContentWindow(i.webPartElementId);r&&r.postMessage(n,i.url)},e.prototype.setTheme=function(e,t){if(!Object(l.h)()){var n=this._iframedWebparts.get(t);if(!n.theme||!Object(s.isEqual)(n.theme,e)){var a={instanceId:t,action:u.e.SetTheme,theme:e};n.theme=e;var i=this._getCurrentIframeWebPartContentWindow(n.webPartElementId);i&&i.postMessage(a,n.url)}}},e.prototype._generateIframeSrcUrl=function(e,t,n){var i,r,o=e+"/_layouts/15/webpart.aspx?";return n.addedFromPersistedData?(o+=f.List+"=%7B",o+=(null===(i=n.isolatedItemContext)||void 0===i?void 0:i.list)||t.list.id,o+="%7D&"+f.Id+"=",o+=(null===(r=n.isolatedItemContext)||void 0===r?void 0:r.id)||t.listItem.id,o+="&"+f.WebPartInstanceId+"=",o+=n.instanceId):(o+=f.NewWebPartInstanceId+"=",o+=n.instanceId),o+="&"+f.ParentWindowOrigin+"=",o+=window.location.origin,o+="&"+f.ComponentId+"=",o+=n.manifest.id,o+="&"+f.HostedInCanvas,a._BrowserUtilities.isTeamsHosted()&&(o+="&"+f.HostedInTeams),o},e.prototype._createPropertyPaneElement=function(e,t){this._pageContentElement||(this._pageContentElement=document.getElementById("spPageChromeAppDiv")),this._iframedPropertyPaneContainer||(this._iframedPropertyPaneContainer=document.createElement("div"),this._iframedPropertyPaneContainer.id="spIFramePropertyPaneContainer",this._iframedPropertyPaneContainer.className="a_a_7caff1a1");var n=this._iframedWebparts.get(e);this._iframeSrcUrl=n.url,this._iframeSrcUrl+="&"+(!Object(l._)()&&t?f.OpenDetailsPropertyPane:f.OpenPropertyPane)+"=true",this._iframedPropertyPaneContainer.innerHTML="\n      <iframe\n        id=dom-isolated-property-pane\n        src="+this._addFilteredQueryParamsFromHostPage(this._iframeSrcUrl)+"\n        class=g_a_7caff1a1\n      ></iframe>",this._pageContentElement.parentElement.appendChild(this._iframedPropertyPaneContainer),this._ppIframeElement=document.getElementById(b)},e.prototype._iframeEventListener=function(e){var t,n,i=this;if(this._iframedWebparts.has(e.data.instanceId)){var o=this._iframedWebparts.get(e.data.instanceId);if(new URL(e.origin).origin.toLowerCase()===e.origin.toLowerCase()){var s=e.data;switch(a.Validate.isNotNullOrUndefined(s.action,"action"),s.action){case u.e.RequestDisplayMode:this._updateWebPartDisplayMode(s.instanceId);break;case u.e.GetOboToken:var c=s.oboRequest,f=c.application,p=c.claims,m=r._AadTokenProviders.configurable;(f===r._AadConstants.PRE_AUTHORIZED_APP_PRINCIPAL_ID?m._oboFirstPartyTokenCallback(p):m._oboThirdPartyTokenCallback(f,p)).then(function(e){i._setOboToken(s.instanceId,e)}).catch(function(){i._setOboToken(s.instanceId,void 0)});break;case u.e.SetDimensions:var _=document.getElementById(o.webPartElementId);if(a.Validate.isNotNullOrUndefined(_,"iframedWebPartElement"),Object(d.n)()){var h=s.height,b=s.instanceId,g=s.isFullScreen,v=s.width;if(g){var y=_.getBoundingClientRect();_.style.cssText="bottom: 0; left: 0; position: fixed; top: 0; z-index: 99999",_.parentElement&&(this._isHostDashboardWebPart(b)?_.parentElement.style.height=y.height+3+"px":_.parentElement.style.width=y.width+"px"),this._getCurrentIframeWebPartContentWindow(o.webPartElementId).postMessage({instanceId:s.instanceId,clientRect:y},o.url)}else null===(t=_.parentElement)||void 0===t||t.style.removeProperty("width"),null===(n=_.parentElement)||void 0===n||n.style.removeProperty("height"),_.style.removeProperty("position"),_.style.removeProperty("top"),_.style.removeProperty("left"),_.style.removeProperty("bottom"),h&&(_.style.height=h+"px"),v&&!this._isHostDashboardWebPart(b)&&(_.style.width=v+"px")}else a.Validate.isNotNullOrUndefined(s.height,"height"),_.style.height=s.height+"px";break;case u.e.UpdateWebPartData:a.Validate.isNotNullOrUndefined(s.webPartData,"webPartData"),this._updateWebPartData(s.instanceId,s.webPartData,u.e.UpdateWebPartData);break;case u.e.UpdatePropertyPaneData:a.Validate.isNotNullOrUndefined(s.webPartData,"webPartData"),this._updateWebPartData(s.instanceId,s.webPartData,u.e.UpdatePropertyPaneData);break;case u.e.UpdatePropertyPaneLifeCycle:"Closed"===s.propertyPaneLifeCycleEvent&&this._hidePropertyPane(e.data.instanceId);break;case u.e.WebPartRenderedInPropertyPaneIframe:var S={instanceId:e.data.instanceId,action:u.e.RequestPropertyPaneAction,propertyPaneAction:"Refresh",webPartData:o.webPartData};this._ppIframeElement.contentWindow.postMessage(S,o.url);break;case u.e.UpdateWebpartLifeCycle:Object(l.u)()||this._updateParentHost(s);break;case u.e.RequestTheme:Object(l.h)()||this._updateThemeInfo(s.instanceId);break;case u.e.RequestPropertyPaneAction:this.requestPropertyPaneAction(s.propertyPaneAction,s.instanceId)}}}},e.prototype._updateThemeInfo=function(e){var t=this._tryGetTheme(e);t&&this.setTheme(t,e)},e.prototype._tryGetTheme=function(e){var t,n;return null===(n=null===(t=this._iframeContextMap.get(e))||void 0===t?void 0:t.serviceScope)||void 0===n?void 0:n.consume(c.ThemeProvider.serviceKey).tryGetTheme()},e.prototype._updateParentHost=function(e){var t=e.instanceId,n=e.parentHostLifeCycle,a=this._iframeContextMap.get(t),i=n,r=i.lifeCycleMethod,o=i.error;switch(r){case"onBeforeWebPartLoad":this._host.onBeforeWebPartLoad(a);break;case"onAfterWebPartLoad":this._host.onAfterWebPartLoad(a);break;case"onBeforeWebPartInitialize":if(l.t.isTeamsContextKSActivated()){this._host.onBeforeWebPartInitializeOld(a);break}this._host.onBeforeWebPartInitialize(a);break;case"onAfterWebPartInitialize":this._host.onAfterWebPartInitialize(a);break;case"onBeforeWebPartRender":this._host.onBeforeWebPartRender(a);break;case"onAfterWebPartRender":this._host.onAfterWebPartRender(a);break;case"onAfterWebPartLoadFailed":o&&this._host.onAfterWebPartLoadFailed(a,o);break;case"onAfterWebPartInitializeFailed":o&&this._host.onAfterWebPartInitializeFailed(a,o);break;case"onAfterWebPartRenderFailed":o&&this._host.onAfterWebPartRenderFailed(a,o)}},e.prototype._updateWebPartDisplayMode=function(e){var t=this._iframedWebparts.get(e),n={instanceId:e,displayMode:t.displayMode,action:u.e.SetDisplayMode},a=this._getCurrentIframeWebPartContentWindow(t.webPartElementId);a&&a.postMessage(n,t.url)},e.prototype._updateWebPartData=function(e,t,n){var a=this._iframedWebparts.get(e);if(!s.isEqual(t,a.webPartData)){a.webPartData=t,this._iframedWebparts.set(e,a),this._host.setDirty(e);var r={instanceId:e,webPartData:t,action:u.e.SetWebPartData};switch(n){case u.e.UpdatePropertyPaneData:var o=document.getElementById(b);o&&o.contentWindow&&o.contentWindow.postMessage(r,a.url);break;case u.e.UpdateWebPartData:var c=this._getCurrentIframeWebPartContentWindow(a.webPartElementId);c&&c.postMessage(r,a.url);break;default:i._TraceLogger.logError(h,new Error('Invalid parameter "action"'))}}},e.prototype._refreshPropertyPane=function(e){if(this._iframedPropertyPaneContainer&&e){var t={instanceId:e,action:u.e.RequestPropertyPaneAction,propertyPaneAction:"Refresh"},n=this._iframedWebparts.get(e);this._ppIframeElement&&this._ppIframeElement.contentWindow&&this._ppIframeElement.contentWindow.postMessage(t,n.url)}},e.prototype._hidePropertyPane=function(e){if(this._iframedPropertyPaneContainer){if(e){var t={instanceId:e,action:u.e.RequestPropertyPaneAction,propertyPaneAction:"Close"},n=this._iframedWebparts.get(e);this._ppIframeElement&&this._ppIframeElement.contentWindow&&this._ppIframeElement.contentWindow.postMessage(t,n.url)}this._iframedPropertyPaneContainer.classList.remove(p),this._iframedPropertyPaneContainer.classList.add(m),this._pageContentElement.classList.remove(_)}},e.prototype._showPropertyPane=function(e,t){var n=this,a=t||"Open";if("Open"===a||"OpenDetails"===a){if(e&&this._iframedWebparts.has(e)){var i=this._iframedWebparts.get(e),r=!Object(l._)()&&"OpenDetails"===a,o=new URL(this._ppIframeElement.src);r?(o.searchParams.delete("openPropertyPane"),o.searchParams.set("openDetailsPropertyPane","true")):(o.searchParams.delete("openDetailsPropertyPane"),o.searchParams.set("openPropertyPane","true")),this._ppIframeElement.src=o.toString();var s={instanceId:e,action:u.e.RequestPropertyPaneAction,propertyPaneAction:a};this._ppIframeElement&&this._ppIframeElement.contentWindow&&this._ppIframeElement.contentDocument&&(this._ppIframeElement.contentDocument.onload=function(){n._ppIframeElement.contentWindow.postMessage(s,i.url)}.bind(this))}this._iframedPropertyPaneContainer.classList.add(p),this._iframedPropertyPaneContainer.classList.remove(m),this._pageContentElement.classList.add(_)}},e.prototype._setOboToken=function(e,t){var n={instanceId:e,oboToken:t,action:u.e.SetOboToken},a=this._iframedWebparts.get(e);this._getCurrentIframeWebPartContentWindow(a.webPartElementId).postMessage(n,a.url)},e.prototype._addFilteredQueryParamsFromHostPage=function(e){for(var t=Object.keys(f).map(function(e){return f[e]}),n=new URL(window.location.href).searchParams,a=0,i=t;a<i.length;a++){var r=i[a];n.has(r)&&n.delete(r)}return e+"&"+n.toString()},e.prototype._getCurrentIframeWebPartContentWindow=function(e){return document.getElementById(e).contentWindow},e.prototype._isHostDashboardWebPart=function(e){var t;return"DashboardWebPart"===(null===(t=this._iframeContextMap.get(e).domElement.parentElement)||void 0===t?void 0:t.dataset.spFeatureTag)},e}();t.default=v}}]);