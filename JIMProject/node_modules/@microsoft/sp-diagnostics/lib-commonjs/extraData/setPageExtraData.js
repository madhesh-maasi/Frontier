"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.setPageExtraData = void 0;
var sp_core_library_1 = require("@microsoft/sp-core-library");
var PromotedState_1 = require("./PromotedState");
var PageType_1 = require("./PageType");
function setPageExtraData(contextInfo, extraData) {
    extraData.pageId = contextInfo.pageId;
    extraData.isHub = contextInfo.isHubSite;
    if (contextInfo.isHubSite) {
        extraData.hubSiteId = contextInfo.hubSiteId;
        extraData.isAssociatedSite = false;
    }
    else if (!contextInfo.isHubSite && contextInfo.hubSiteId) {
        // If isHubSite is false, but hubSiteId is set, we call it associatedSite
        extraData.isAssociatedSite = true;
    }
    else {
        extraData.isAssociatedSite = false;
    }
    if (sp_core_library_1._BrowserUtilities.isTeamsHosted()) {
        extraData.displayApp = "Teams" /* Teams */;
    }
    else {
        extraData.displayApp = "Sharepoint" /* Sharepoint */;
    }
    extraData.userAgent = navigator.userAgent;
    var webTemplate = contextInfo.webTemplate;
    extraData.webTemplate = webTemplate;
    var siteType;
    if (webTemplate === "1" /* TeamSite */) {
        siteType = 'TeamSite';
    }
    else if (webTemplate === "64" /* GroupSite */) {
        siteType = 'GroupSite';
    }
    else if (webTemplate === "68" /* SitePagePublishing */) {
        siteType = 'CommunicationSite';
    }
    var promotedState = contextInfo.promotedState;
    var pageLayoutType = contextInfo.pageType;
    var pageType = pageLayoutType;
    if (pageLayoutType === PageType_1.PageType.Article) {
        if (promotedState === PromotedState_1.PromotedState.NotPromoted || promotedState === undefined) {
            pageType = PageType_1.PageType.Article;
        }
        else {
            pageType = PageType_1.PageType.News;
        }
    }
    extraData.siteType = siteType;
    extraData.pageType = pageType;
}
exports.setPageExtraData = setPageExtraData;
//# sourceMappingURL=setPageExtraData.js.map