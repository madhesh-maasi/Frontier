"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
var tslib_1 = require("tslib");
var sp_core_library_1 = require("@microsoft/sp-core-library");
var MSGraphClient_1 = tslib_1.__importDefault(require("./MSGraphClient"));
/**
 * Returns a preinitialized version of the MSGraphClient.
 * For more information: {@link https://docs.microsoft.com/en-us/sharepoint/dev/spfx/use-msgraph}
 *
 * @public
 */
var MSGraphClientFactory = /** @class */ (function () {
    /**
     * @param serviceScope - Provides services for the MSGraphClient to consume.
     *
     * @internal
     */
    function MSGraphClientFactory(serviceScope) {
        this._serviceScope = serviceScope;
    }
    /**
     * Returns an instance of the MSGraphClient that communicates with the current tenant's configurable
     * Service Principal.
     */
    MSGraphClientFactory.prototype.getClient = function () {
        var _this = this;
        /* tslint:disable:next-line no-any */
        if (!MSGraphClient_1.default._instance) {
            return Promise.resolve().then(function () { return tslib_1.__importStar(require(
            /* webpackChunkName: 'sp-http-msgraphclient' */ '@microsoft/microsoft-graph-client/lib/graph-js-sdk-web')); }).then(function () {
                return new MSGraphClient_1.default(_this._serviceScope);
            });
        }
        else {
            return Promise.resolve(new MSGraphClient_1.default(this._serviceScope));
        }
    };
    /**
     * The service key for MSGraphClientFactory.
     */
    MSGraphClientFactory.serviceKey = sp_core_library_1.ServiceKey.create('sp-http:MSGraphClientFactory', MSGraphClientFactory);
    return MSGraphClientFactory;
}());
exports.default = MSGraphClientFactory;
//# sourceMappingURL=MSGraphClientFactory.js.map