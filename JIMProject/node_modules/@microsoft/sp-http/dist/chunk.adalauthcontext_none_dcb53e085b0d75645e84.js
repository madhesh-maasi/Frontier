(window.webpackJsonpc07208f0_ea3b_4c1a_9965_ac1b825211a6_1_14_0=window.webpackJsonpc07208f0_ea3b_4c1a_9965_ac1b825211a6_1_14_0||[]).push([[1],{nUPw:function(e,t,n){"use strict";n.d(t,"e",function(){return s});var a=n("jtSf"),i=n("MGiw"),r=n("UWqr"),o=n("NJ9J"),s=function(){function e(){}return e._handleInteractionRequiredFailures=function(t,n,s){e._doesAadErrorCodeExist(n,i.e.UNRESOLVABLE_AAD_ERROR_CODES)||i.e.RESOLVABLE_ERROR_CODES.forEach(function(e){if(n.indexOf(e)>-1){var i=t._getNavigateUrl(t.RESPONSE_TYPE.TOKEN,s)+"&prompt=select_account";r._SPEventManager.instance.raiseEvent(a.n._tokenAcquisitionEventId,new a.t(o.e,i))}})},e._isInteractionRequired=function(t,n){return!e._doesAadErrorCodeExist(t,i.e.UNRESOLVABLE_AAD_ERROR_CODES)&&i.e.RESOLVABLE_ERROR_CODES.has(n)},e._isTokenRenewalTimeout=function(e){return e===i.e.TOKEN_RENEWAL_TIMEOUT},e._isEndpointsResolutionError=function(e){return e===i.e.ENDPOINTS_RESOLUTION_ERROR},e._doesAadErrorCodeExist=function(e,t){for(var n=0,a=e.match(/(AADSTS)[0-9]+/g)||[];n<a.length;n++){var i=a[n];if(t.has(i))return!0}return!1},e}()},z1gO:function(e,t,n){"use strict";n.r(t),n.d(t,"AdalAuthContextManager",function(){return m});var a=n("UWqr"),i=n("/Vh9"),r=n("17wl"),o=n("MGiw"),s=n("ut3N"),c=n("nUPw"),d=n("+3E/"),l=function(e){function t(t,n){var a=e.call(this,t)||this;return a._errorCode=n,a}return Object(r.__extends)(t,e),Object.defineProperty(t.prototype,"errorCode",{get:function(){return this._errorCode},enumerable:!1,configurable:!0}),t}(Error),u=function(){function e(e,t){this.clientId=e.config.clientId,this._aadUserId=t||"",this._patchAdalAuthContext(e),this._authContext=e,this._extraQueryParameter=e.config.extraQueryParameter}return e.prototype.getToken=function(e,t){var n=this,i=new s._QosMonitor("AdalTokenProvider.GetToken"),r={alias:"false",CorrelationId:a.Guid.newGuid().toString(),isInternal:this.clientId===o.e.PRE_AUTHORIZED_APP_PRINCIPAL_ID};return this._getAccessToken(e,t,r).then(function(t){return d.e.isLogAadAdditionalTelemetryEnabled()&&r.isInternal&&(r.name=e),i.writeSuccess(r),t}).catch(function(t){throw c.e._handleInteractionRequiredFailures(n._authContext,t.message,e),n._monitorAndThrowForAccessTokenExpectedFailures(i,t,e,r),i.writeUnexpectedFailure(t.errorCode,t,r),t})},e.prototype._getAccessToken=function(e,t,n){var i=this._tryGetCachedAccessToken(e);return t&&i?(n.CorrelationId=a.Guid.empty.toString(),n.alias="true",Promise.resolve(i)):this._fetchAccessToken(e,n)},e.prototype._tryGetCachedAccessToken=function(e){var t;try{t=this._authContext.getCachedToken(e);var n=this._authContext._extractIdToken(t);n.oid===this._aadUserId&&n.appid===this.clientId||(t=void 0)}catch(e){}return t},e.prototype._fetchAccessToken=function(e,t){var n=this,i=new s._QosMonitor("AdalTokenProvider.AcquireAccessTokenSilent");return this._authContext.config.correlationId=t.CorrelationId,this._authContext.config.extraQueryParameter=this._extraQueryParameter,this._fetchAccessTokenSilent(e).catch(function(e){n._authContext.config.extraQueryParameter=void 0}).then(function(i){if(i)return i;var r=a.Guid.newGuid().toString();return n._authContext.config.correlationId=r,t.CorrelationId=r,n._fetchAccessTokenSilent(e)}).catch(function(a){throw n._authContext.config.extraQueryParameter=n._extraQueryParameter,n._monitorAndThrowForAccessTokenExpectedFailures(i,a,e,t),a.message.indexOf("Token renewal operation failed due to timeout")>-1&&(a.message=a.message+" - AADCorrelationId: "+t.CorrelationId+" - ClientId: "+n.clientId),i.writeUnexpectedFailure(a.errorCode,a,t),a}).then(function(e){return n._authContext.config.extraQueryParameter=n._extraQueryParameter,i.writeSuccess(t),e})},e.prototype._monitorAndThrowForAccessTokenExpectedFailures=function(e,t,n,a){if(c.e._doesAadErrorCodeExist(t.message,o.e.EXPECTED_AAD_ERRORS))throw e.writeExpectedFailure(t.errorCode,t,a),t},e.prototype._fetchAccessTokenSilent=function(e){var t=this;return new Promise(function(n,a){t._authContext.acquireToken(e,function(e,t,i){t?n(t):a(new l("Error - Type : "+i+" - Description : "+e,i))})})},e.prototype._patchAdalAuthContext=function(e){var t=this;Object.getPrototypeOf(e)._singletonInstance=void 0,e._addAdalFrame=function(n){return t._addAdalFrame(e,n)},e._loadFrame=function(n,a){return t._loadFrame(e,n,a)},e._user={},e._saveItem(e.CONSTANTS.STORAGE.LOGIN_REQUEST,window.location.href)},e.prototype._addAdalFrame=function(e,t){if(void 0!==t){e.info("Add adal frame to document:"+t);var n=document.getElementById(t),a="allow-same-origin allow-scripts allow-forms allow-pointer-lock";if(!n){if(document.createElement&&document.documentElement&&(window.opera||-1===window.navigator.userAgent.indexOf("MSIE 5.0"))){var i=document.createElement("iframe");i.setAttribute("id",t),i.setAttribute("aria-hidden","true"),i.setAttribute("sandbox",a),i.style.visibility="hidden",i.style.position="absolute",i.style.width=i.style.height=i.style.border="0",n=document.getElementsByTagName("body")[0].appendChild(i)}else document.body&&document.body.insertAdjacentHTML&&document.body.insertAdjacentHTML("beforeEnd",'<iframe sandbox="'+a+'" name="'+t+'" id="'+t+'" style="display:none"></iframe>');var r=window.frames;r&&r[t]&&(n=r[t])}return n}},e.prototype._loadFrame=function(e,t,n){e.info("LoadFrame: "+n),e._addAdalFrame(n).src=t},e}(),f=n("5q05"),p=function(){function e(e,t,n,i){var r=this;this._oboFirstPartyTokenCallback=n,this._oboThirdPartyTokenCallback=i,this._exchange1PTokenFor3P=function(e,t){return r._oboFirstPartyTokenCallback?(r._oboFirstPartyTokenRequest&&!t||(r._oboFirstPartyTokenRequest=r._oboFirstPartyTokenCallback(e,t).then(function(n){if(!n)throw new Error("_oboFirstPartyTokenCallback returned empty token");if(!a._SPKillSwitch.isActivated("4b8e649b-d661-478a-8b33-1cd2bb62fd71")&&r._isTokenExpired(n)){if(t)throw new Error("Failed to refresh an expired token");return r._oboFirstPartyTokenCallback(e,!0)}return Promise.resolve(n)}).then(function(e){if(!e)throw new Error("_oboFirstPartyTokenCallback returned empty token");var t=r._serverRelativeUrl+"/_api/Microsoft.SharePoint.Internal.ClientSideComponent.Token.AcquireOBOToken?resource='"+r._authContext.config.clientId+"'&clientId='"+o.e.PRE_AUTHORIZED_APP_PRINCIPAL_ID+"'",n={headers:{"X-HTTP-Method":"GET","OData-Version":"3.0",OBOToken:e,ClientId:o.e.PRE_AUTHORIZED_APP_PRINCIPAL_ID,Resource:r._authContext.config.clientId}};return r._spHttpClient.get(t,f.e.configurations.v1,n)}).then(function(e){return e.ok?e.json():Promise.reject(e.json())}).then(function(e){return JSON.parse(e.value).AccessToken}).catch(function(e){throw r._oboFirstPartyTokenRequest=void 0,e})),r._oboFirstPartyTokenRequest):Promise.reject()},this.servicePrincipalId=e.config.clientId,this._patchAdalAuthContext(e),this._authContext=e,this._serverRelativeUrl=t.serverRelativeUrl,this._spHttpClient=t.spHttpClient}return e.prototype.getToken=function(e,t){void 0===t&&(t=!0);var n=new s._QosMonitor("OboTokenProvider.GetToken");return this._getAccessToken(e,t).then(function(e){return n.writeSuccess(),e}).catch(function(e){throw n.writeUnexpectedFailure("TokenAcquisitionFailure",e),e})},e.prototype._getAccessToken=function(e,t){var n=this._tryGetCachedAccessToken(e);return t&&n?Promise.resolve(n):this._fetchAccessToken(e)},e.prototype._tryGetCachedAccessToken=function(t){var n;try{n=this._authContext.getCachedToken(t)}catch(t){s._TraceLogger.logError(e._logSource,t)}return n},e.prototype._fetchAccessToken=function(e){var t=new s._QosMonitor("OboTokenProvider.FetchAccessToken");return this._fetchAccessTokenSilent(e).then(function(e){return t.writeSuccess(),e}).catch(function(e){throw e.message&&c.e._doesAadErrorCodeExist(e.message,o.e.EXPECTED_AAD_ERRORS)?t.writeExpectedFailure("TokenAcquisitionFailure",e):t.writeUnexpectedFailure("TokenAcquisitionFailure",e),e})},e.prototype._getOboAuthToken=function(e,t){var n=this;if(!a._SPKillSwitch.isActivated("6bc5fca9-bc8f-4cd4-9a48-7f262e076016")&&!this._oboFirstPartyTokenCallback&&!this._oboThirdPartyTokenCallback)return Promise.resolve("");var i=new s._QosMonitor(t?"OboTokenProvider.GetOboAuthTokenRetry":"OboTokenProvider.GetOboAuthToken"),r={IsClaimsPresent:!!e,IsRefreshOboAuthTokenFlow:!!t},c=this._authContext.config.clientId;return Promise.resolve(void 0),(c===o.e.PRE_AUTHORIZED_APP_PRINCIPAL_ID&&this._oboFirstPartyTokenCallback?this._oboFirstPartyTokenCallback(e,t):this._oboThirdPartyTokenCallback?this._oboThirdPartyTokenCallback(this._authContext.config.clientId,e,t).catch(function(){return n._exchange1PTokenFor3P(e,t)}):this._exchange1PTokenFor3P(e,t)).then(function(o){if(!a._SPKillSwitch.isActivated("6ad2e936-9352-4e10-8d24-8fe7458ecc2b")&&n._isTokenExpired(o,r)){if(t)throw new Error("Failed to refresh an expired token");return n._getOboAuthToken(e,!0)}return i.writeSuccess(r),o}).catch(function(e){return i.writeUnexpectedFailure(void 0,e,r),""})},e.prototype._isTokenExpired=function(e,t){if(void 0!==e){var n=(a=e)?function(e){if(!e)return{};try{var t=atob(e.replace(/-/g,"+").replace(/_/g,"/"));return JSON.parse(t)}catch(e){return{}}}(decodeURIComponent(a).split(".")[1]):{};return t&&(t.TokenExpiration=n.exp?1e3*n.exp:-1,t.TimeCheckingTokenExpiration=Date.now()),!function(e,t){void 0===t&&(t=Date.now());var n=t/1e3;if(!e)return!1;var a=e.exp,i=e.nbf;return("number"!=typeof i||n>=i)&&("number"!=typeof a||n<a)}(n)}var a;return!1},e.prototype._fetchAccessTokenSilent=function(t,n){var i=this;return this._getOboAuthToken(n).then(function(o){var s=i._serverRelativeUrl+"/_api/Microsoft.SharePoint.Internal.ClientSideComponent.Token.AcquireOBOToken?resource='"+t+"'&clientId='"+i._authContext.config.clientId+"'",c={headers:{"X-HTTP-Method":"GET","OData-Version":"3.0"}};return o&&(c.headers.OBOToken=o),a._SPKillSwitch.isActivated(e.useHeadersKillSwitchGuid,"1/9/2020","Use headers for requesting tokens")||(c.headers=Object(r.__assign)(Object(r.__assign)({},c.headers),{ClientId:i._authContext.config.clientId,Resource:t})),i._spHttpClient.get(s,f.e.configurations.v1,c).then(function(e){if(e.ok)return e.json();if(401===e.status){var a=e.headers.get("WWW-Authenticate");if(!n&&a){var r=a.split(",").map(function(e){var t=e.indexOf("=");return[e.substr(0,t),e.substr(t+1)]}).filter(function(e){return"claims"===e[0]})[0][1].replace(/"/g,"");return i._fetchAccessTokenSilent(t,[r])}}return Promise.reject(e.json())}).then(function(e){return"string"==typeof e?e:JSON.parse(e.value).AccessToken})})},e.prototype._patchAdalAuthContext=function(e){Object.getPrototypeOf(e)._singletonInstance=void 0},e._logSource=s._LogSource.create("OBOTokenProvider"),e.useHeadersKillSwitchGuid=a.Guid.parse("6f64a6ed-dc35-422c-a368-539dd03f9b9b"),e}(),m=function(){function e(){this._loadAdalJsModulePromise=void 0,this._authContextDictionary=new Map}return e.convertTokenParametersToConfig=function(e){var t,n=e.userPrincipalName;n&&(t="login_hint="+encodeURIComponent(n));var i=a.UrlUtilities.removeEndSlash(e.aadInstanceUrl)+"/";return{clientId:e.servicePrincipalId,redirectUri:e.redirectUri,instance:i,loadFrameTimeout:1e4,tenant:e.aadTenantId,navigateToLoginRequestUrl:!1,extraQueryParameter:t}},e.prototype.getOboTokenProvider=function(t,n,a,r){return new p(i.inject(e.convertTokenParametersToConfig(t)),n,a,r)},e.prototype.getAdalTokenProvider=function(t){if(!this._authContextDictionary.has(t.servicePrincipalId)){var n=new u(i.inject(e.convertTokenParametersToConfig(t)),t.aadUserId);this._authContextDictionary.set(t.servicePrincipalId,n)}return this._authContextDictionary.get(t.servicePrincipalId)},e}()}}]);