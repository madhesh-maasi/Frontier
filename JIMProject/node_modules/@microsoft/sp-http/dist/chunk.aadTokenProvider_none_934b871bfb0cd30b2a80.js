(window.webpackJsonpc07208f0_ea3b_4c1a_9965_ac1b825211a6_1_14_0=window.webpackJsonpc07208f0_ea3b_4c1a_9965_ac1b825211a6_1_14_0||[]).push([[0],{"+3E/":function(e,t,n){"use strict";n.d(t,"e",function(){return i}),n.d(t,"t",function(){return r});var a=n("UWqr"),i=function(){function e(){}return e.isAdditionalMsalTelemetryEnabled=function(){return!a._SPKillSwitch.isActivated(a.Guid.parse("0f83cdbf-a595-48d6-a1b5-ff70e5daf777"),"03/26/20","Add additional telemetry for MSAL calls")},e.isLogAadAdditionalTelemetryEnabled=function(){return!a._SPKillSwitch.isActivated(a.Guid.parse("d6619064-d4fc-4659-8306-7e9edb59d871"),"04/13/20","Add additional logging for the time it takes to fetch Aad tokens")},e.isUpdateTokenForImplicitTokenProviderEnabled=function(){return!a._SPKillSwitch.isActivated(a.Guid.parse("d4f4cc58-9fc2-47f1-a5df-66add6851f7c"),"09/08/20","Allow ImplicitTokenProvider update token")},e.isRetryTimeoutsEnabled=function(){return!a._SPKillSwitch.isActivated("8677b99c-f245-43dd-8e78-a6f512170c24")},e.isRetryWithLoginHintEnabled=function(){return!a._SPKillSwitch.isActivated("a7bec1ab-8f5f-43dc-8723-b7160b9430b5")},e.isRetryIdTokenWithLoginHintEnabled=function(){return!a._SPKillSwitch.isActivated("343c4c23-c2a0-4fb5-8e8a-334c8bad48e5")},e.isRetryOnResolveEndpointsFailureEnabled=function(){return!a._SPKillSwitch.isActivated("d156f602-a884-45d4-817b-afb6405eb98d")},e.isBlockLoginHintForGuestsEnabled=function(){return!a._SPKillSwitch.isActivated(a.Guid.parse("e9d6178f-673d-4440-9463-0ba7c6f4d1f9"),"03/11/2021","Block login hint for guests")},e.isRemoveDuplicateHandleAuthErrorsCallEnabled=function(){return!a._SPKillSwitch.isActivated(a.Guid.parse("c907e22b-ea94-450f-b7fb-4997f62582e1"),"04/21/2021","Remove duplicate handleAuthErrors() call")},e.isPrintMsalConsoleLogsEnabled=function(){return!a._SPKillSwitch.isActivated(a.Guid.parse("1449034c-1045-4c29-a6ec-e13544fce8ee"),"07/01/2021","Allow msal.js logs to print to console via QSP")},e.isPreventingEmptyFromCacheEnabled=function(){return!a._SPKillSwitch.isActivated(a.Guid.parse("5a2b94bf-6f55-4195-a863-79b7061d7d94"),"07/09/2021","Prevent fromCache property of MSAL response to be undefined")},e.isCheckClientAuthErrorsEnabled=function(){return!a._SPKillSwitch.isActivated(a.Guid.parse("cade5bf7-d2a1-4f93-9507-93ee7c8b9443"),"07/21/21","Allow MsalTokenProvider to check against ClientAuthErrors")},e.isRemoveIEUnexpectedErrorsEnabled=function(){return!a._SPKillSwitch.isActivated(a.Guid.parse("c0683f91-28dc-40bb-b5e0-b2b0cc900c68"),"08/31/21","Mark unexpected QoS errors from IE to be set as expected")},e.isHaveFirstAndThirdOboProvidersEnabled=function(){return!a._SPKillSwitch.isActivated(a.Guid.parse("d5de0648-1f02-4505-89e4-359a4046b7dd"),"09/16/21","Have separate first and third party obo providers")},e.isRedirectPreventionOnTokenFetchFailureEnabled=function(){return!a._SPKillSwitch.isActivated(a.Guid.parse("8bb41e23-012b-480c-aa50-1b58c24a83d1"),"10/09/21","Add param for preventing page redirect to login page when getting auth token fails")},e}();function r(){return!a._SPKillSwitch.isActivated("dd3dba4e-4baa-4bd3-95bf-64ffae9b7b51")}},NUTh:function(e,t,n){"use strict";n.r(t),n.d(t,"DeferredAadTokenProvider",function(){return d});var a=n("UWqr"),i=n("ut3N"),r=n("NJ9J"),o=n("MGiw"),s=n("wRfT"),c=n("+3E/"),d=function(){function e(e,t,n,i,r,o){this._oboFirstPartyTokenCallback=r,this._oboThirdPartyTokenCallback=o,a.Validate.isNonemptyString(n.aadInstanceUrl,"aadInstanceUrl"),a.Validate.isNonemptyString(n.aadTenantId,"aadTenantId"),a.Validate.isNonemptyString(n.redirectUri,"redirectUri"),a.Validate.isNonemptyString(n.servicePrincipalId,"servicePrincipalId"),this._defaultConfiguration=n,this._oboConfiguration=i,this._tokenAcquisitionEvent=e,this.onBeforeRedirectEvent=t,this._failedTokenRequests=new Map}return e.prototype.getToken=function(e,t){return void 0===t&&(t=!0),this._defaultConfiguration.servicePrincipalId===a.Guid.empty.toString()?Promise.reject(new Error(r.n)):this._getTokenInternal(e,this._defaultConfiguration,t)},e.prototype._getTokenData=function(e,t,n){if(void 0===t&&(t=!0),void 0===n&&(n=!1),this._defaultConfiguration.servicePrincipalId===a.Guid.empty.toString())return Promise.reject(new Error(r.n));if(this._shouldUseMsalTokenProvider())return this._getMsalTokenProvider(this._defaultConfiguration).then(function(a){return a.getTokenData(e,t,n)});throw new Error("Getting token response not supported for the current token provider")},e.prototype._getTokenInternal=function(e,t,n){var r=this;void 0===n&&(n=!0);var s=new i._QosMonitor("AadTokenProvider.GetAppTokenTimePerf");if(!this._shouldTokenBeRequested(e))throw s.writeExpectedFailure("Token already requested and failed"),Error("Token request previously failed");var d=t||this._defaultConfiguration;return(this._shouldUseOboTokenExchange()&&this._oboConfiguration?this._getOboTokenProvider(a._SPFlight.isEnabled(60254)?d:this._defaultConfiguration,this._oboConfiguration,this._oboFirstPartyTokenCallback,this._oboThirdPartyTokenCallback).then(function(t){return r._getToken(t,e,n)}):this._shouldUseMsalTokenProvider()?this._getMsalTokenProvider(d).then(function(t){return r._getToken(t,e,n)}):this._getImplicitTokenProvider(d).then(function(t){return r._getToken(t,e,n)})).then(function(t){if(c.e.isLogAadAdditionalTelemetryEnabled()){var n=d.servicePrincipalId===o.e.PRE_AUTHORIZED_APP_PRINCIPAL_ID,a={isInternal:n};n&&(a.name=e),s.writeSuccess(a)}return t}).catch(function(t){throw c.e.isLogAadAdditionalTelemetryEnabled()&&s.writeUnexpectedFailure(),r._addFailedRequest(e),t})},e.prototype._addFailedRequest=function(e){Object(c.t)()&&this._failedTokenRequests.set(e,new Date(Date.now()))},e.prototype._shouldTokenBeRequested=function(e){if(Object(c.t)()){var t=this._failedTokenRequests.get(e);if(t)return Date.now()-t.getTime()>3e5}return!0},e.prototype._getToken=function(e,t,n){return e.getToken(t,n)},Object.defineProperty(e.prototype,"tokenAcquisitionEvent",{get:function(){return this._tokenAcquisitionEvent},enumerable:!1,configurable:!0}),e.prototype._shouldUseMsalTokenProvider=function(){var e=!!a.Guid.tryParse(this._defaultConfiguration.aadSessionId),t=e||s.e.isRemoveLegacyAuthProvidersFlightEnabled();if(!e){t&&(this._defaultConfiguration.aadSessionId="");var n=new i._QosMonitor("DeferredAadTokenProvider._shouldUseMsalTokenProvider"),r={aadSessionId:this._defaultConfiguration.aadSessionId};n.writeUnexpectedFailure("isAadSessionIdValidGuid",void 0,r)}return t},e.prototype._getAdalAuthContextManager=function(e){return this._authContextManager||(this._authContextManager=Promise.all([n.e(6),n.e(1)]).then(n.bind(null,"z1gO")).then(function(e){return new e.AdalAuthContextManager})),this._authContextManager},e.prototype._getMsalTokenProvider=function(e){var t=this;return Promise.all([n.e(7),n.e(3)]).then(n.bind(null,"X7FI")).then(function(n){return t._isFirstParty(e.servicePrincipalId)?(t._firstPartyMsalTokenProvider||(t._firstPartyMsalTokenProvider=new n.MsalTokenProvider(e)),t._firstPartyMsalTokenProvider):(t._thirdPartyMsalTokenProvider||(t._thirdPartyMsalTokenProvider=new n.MsalTokenProvider(e)),t._thirdPartyMsalTokenProvider)})},e.prototype._getImplicitTokenProvider=function(e){var t=this;return n.e(5).then(n.bind(null,"onrO")).then(function(n){return t._isFirstParty(e.servicePrincipalId)?(t._firstPartyImplicitTokenProvider||(t._firstPartyImplicitTokenProvider=new n.ImplicitFlowTokenProvider(e)),t._firstPartyImplicitTokenProvider):(t._thirdPartyImplicitTokenProvider||(t._thirdPartyImplicitTokenProvider=new n.ImplicitFlowTokenProvider(e)),t._thirdPartyImplicitTokenProvider)})},e.prototype._getOboTokenProvider=function(e,t,n,a){var i=this;return this._getAdalAuthContextManager(e).then(function(r){return c.e.isHaveFirstAndThirdOboProvidersEnabled()&&i._isFirstParty(e.servicePrincipalId)?(i._firstPartyOboTokenProvider||(i._firstPartyOboTokenProvider=r.getOboTokenProvider(e,t,n,a)),i._firstPartyOboTokenProvider):(i._thirdPartyOboTokenProvider||(i._thirdPartyOboTokenProvider=r.getOboTokenProvider(e,t,n,a)),i._thirdPartyOboTokenProvider)})},e.prototype._isFirstParty=function(e){return e===o.e.PRE_AUTHORIZED_APP_PRINCIPAL_ID},e.prototype._shouldUseOboTokenExchange=function(){return!!this._oboConfiguration},e.msalTrialRunKillSwitchGuid=a.Guid.parse("fa0b23a7-7b4e-4fbe-b635-bbed397c3ef5"),e}()},wRfT:function(e,t,n){"use strict";n.d(t,"e",function(){return i});var a=n("UWqr"),i=function(){function e(){}return e.isRemoveLegacyAuthProvidersFlightEnabled=function(){return a._SPFlight.isEnabled(60446)},e.isMsalVersionBumpTo1413Enabled=function(){return a._SPFlight.isEnabled(60555)},e}()}}]);