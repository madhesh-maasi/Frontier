(window.webpackJsonpc07208f0_ea3b_4c1a_9965_ac1b825211a6_1_14_0=window.webpackJsonpc07208f0_ea3b_4c1a_9965_ac1b825211a6_1_14_0||[]).push([[3],{X7FI:function(e,t,n){"use strict";n.r(t),n.d(t,"MsalTokenProvider",function(){return h});var a=n("17wl"),i=n("ut3N"),r=n("jtSf"),o=n("UWqr"),s=n("MGiw"),c=n("nUPw"),d=n("+3E/"),l=n("wRfT"),u=n("O2Sl"),f=n("3D3l"),p=n("4zVt"),m=n("UatF"),_=n("w4+A"),h=function(){function e(e){this._defaultConfiguration=e,this._requestMap=new Map,this._msalInstance=this._initializeMsalJs(),this._allowedRedirectAttempts=Object(_.e)()?13:7}return e.prototype.getToken=function(e,t){return void 0===t&&(t=!0),this.getTokenData(e,t).then(function(e){return e.accessToken})},e.prototype.getTokenData=function(e,t,n){var a,r=this;void 0===t&&(t=!0),void 0===n&&(n=!1);var s=this._generateTelemetryExtraData();n||(a=new i._QosMonitor("MsalTokenProvider.GetTokenData")),d.e.isLogAadAdditionalTelemetryEnabled()&&s.isInternal&&(s.name=e);var c,l=o._BrowserDetection.getBrowserInformation().browser;return c=l===o._Browser.IE||l===o._Browser.Edge?this._loginSilent().then(function(){return r._acquireTokenData(e,n)}):this._acquireTokenData(e,n),s.CorrelationId=this._defaultConfiguration.spRequestGuid||o.Guid.newGuid().toString(),c.then(function(e){return null==a||a.writeSuccess(s),e}).catch(function(t){if(n)throw t;if(d.e.isRemoveDuplicateHandleAuthErrorsCallEnabled()&&a)throw r._isExpectedFailure(t)?a.writeExpectedFailure(t.errorCode,t,s):r._writeUnexpectedFailure(a,t.errorCode,t,s),t;r._handleAuthErrors(a,t,s,e)})},e.prototype._loginSilent=function(){var e=new i._QosMonitor("MsalTokenProvider.GetIdToken");return this._loginSilentHelper(0,e)},e.prototype._loginSilentHelper=function(e,t){var n,a=this;e>0&&(n=new i._QosMonitor("MsalTokenProvider.RetryGetIdToken"));var r=this._generateTelemetryExtraData(),o={authority:this._defaultConfiguration.aadInstanceUrl+"/"+this._defaultConfiguration.aadTenantId,correlationId:r.CorrelationId,loginHint:this._defaultConfiguration.userPrincipalName,scopes:[this._defaultConfiguration.servicePrincipalId]};return 0===e&&(o.sid=this._defaultConfiguration.aadSessionId,o.loginHint=void 0),this._msalInstance.acquireTokenSilent(o).then(function(e){return r.alias=d.e.isPreventingEmptyFromCacheEnabled()?(!!e.fromCache).toString():e.fromCache.toString(),d.e.isAdditionalMsalTelemetryEnabled()&&(r.jsonExtraData=JSON.stringify(a._requestMap.get(r.CorrelationId))),t.writeSuccess(r),e.accessToken}).catch(function(i){if(d.e.isAdditionalMsalTelemetryEnabled()&&(r.jsonExtraData=JSON.stringify(a._requestMap.get(r.CorrelationId))),a._writeUnexpectedFailure(n,i.errorCode,i,r),d.e.isRetryIdTokenWithLoginHintEnabled()&&c.e._isInteractionRequired(i.message,i.errorCode)&&e<1)return a._loginSilentHelper(++e,t);a._handleAuthErrors(t,i,r,a._defaultConfiguration.servicePrincipalId)})},e.prototype._acquireTokenData=function(e,t){var n;return void 0===t&&(t=!1),t||(n=new i._QosMonitor("MsalTokenProvider.GetAccessTokenData")),this._acquireTokenDataHelper(e,0,n)},e.prototype._acquireTokenDataHelper=function(e,t,n,a){var r,o=this;void 0===a&&(a=!1),t>0&&(r=a?new i._QosMonitor("MsalTokenProvider.RetryLoginHintGetAccessToken"):new i._QosMonitor("MsalTokenProvider.RetryGetAccessToken"));var s=this._generateTelemetryExtraData(),l={authority:this._defaultConfiguration.aadInstanceUrl+"/"+this._defaultConfiguration.aadTenantId,correlationId:s.CorrelationId,loginHint:this._defaultConfiguration.userPrincipalName,scopes:[e+"/.default"]};return a||(l.sid=this._defaultConfiguration.aadSessionId,l.loginHint=void 0),this._msalInstance.acquireTokenSilent(l).then(function(e){return s.alias=d.e.isPreventingEmptyFromCacheEnabled()?(!!e.fromCache).toString():e.fromCache.toString(),d.e.isAdditionalMsalTelemetryEnabled()&&(s.jsonExtraData=JSON.stringify(o._requestMap.get(s.CorrelationId))),null==n||n.writeSuccess(s),null==r||r.writeSuccess(s),e}).catch(function(a){if(d.e.isAdditionalMsalTelemetryEnabled()&&(s.jsonExtraData=JSON.stringify(o._requestMap.get(s.CorrelationId))),o._writeUnexpectedFailure(r,a.errorCode,a,s),d.e.isRetryTimeoutsEnabled()&&c.e._isTokenRenewalTimeout(a.errorCode)&&t<1||d.e.isRetryOnResolveEndpointsFailureEnabled()&&c.e._isEndpointsResolutionError(a.errorCode)&&t<1)return o._acquireTokenDataHelper(e,++t,n);if(d.e.isRetryWithLoginHintEnabled()&&(!d.e.isBlockLoginHintForGuestsEnabled()||o._defaultConfiguration.userPrincipalName)&&(c.e._isInteractionRequired(a.message,a.errorCode)||o._isUserLoginError(a))&&t<1)return o._acquireTokenDataHelper(e,++t,n,!0);if(!n)throw a;o._handleAuthErrors(n,a,s,e)})},e.prototype._initializeMsalJs=function(){var e,t=this;return e=o._SPFlight.isEnabled(467)?{auth:{clientId:this._defaultConfiguration.servicePrincipalId,navigateToLoginRequestUrl:!0,redirectUri:this._defaultConfiguration.redirectUri,validateAuthority:!1,authority:this._defaultConfiguration.aadInstanceUrl+"/"+this._defaultConfiguration.aadTenantId},system:{loadFrameTimeout:1e4,navigateFrameWait:0}}:{auth:{clientId:this._defaultConfiguration.servicePrincipalId,navigateToLoginRequestUrl:!1,redirectUri:this._defaultConfiguration.redirectUri,validateAuthority:!1},system:{loadFrameTimeout:1e4,navigateFrameWait:0}},d.e.isAdditionalMsalTelemetryEnabled()&&(e.system.telemetry={applicationName:this._defaultConfiguration.servicePrincipalId,applicationVersion:"1.0",telemetryEmitter:function(e){var n="",i={};e.forEach(function(e){"msal.api_event"===e["msal.event_name"]?(n=e["Microsoft.MSAL.correlation_id"],i=Object(a.__assign)(Object(a.__assign)(Object(a.__assign)({},i),t._requestMap.get(n)),e)):"msal.default_event"===e["msal.event_name"]&&(i=Object(a.__assign)(Object(a.__assign)({},i),{"msal.effective_connection_speed":e["msal.effective_connection_speed"]}))}),t._requestMap.set(n,i)}}),l.e.isMsalVersionBumpTo1413Enabled()?(d.e.isPrintMsalConsoleLogsEnabled()&&this._shouldPrintMsalLogsToConsole()&&(e.system.logger=new u.t(this._msalLoggerCallback,{level:u.e.Verbose,piiLoggingEnabled:!0})),new f.e(e)):(d.e.isPrintMsalConsoleLogsEnabled()&&this._shouldPrintMsalLogsToConsole()&&(e.system.logger=new p.t(this._msalLoggerCallback,{level:p.e.Verbose,piiLoggingEnabled:!0})),new m.e(e))},e.prototype._generateTelemetryExtraData=function(){return{alias:"false",CorrelationId:o.Guid.newGuid().toString(),isInternal:this._defaultConfiguration.servicePrincipalId===s.e.PRE_AUTHORIZED_APP_PRINCIPAL_ID,jsonExtraData:""}},e.prototype._cancelRedirect=function(){this._redirectCancelled=!0},e.prototype._handleAuthErrors=function(e,t,n,a){var i=this,l=o._BrowserDetection.getBrowserInformation().userAgent||"";if(o._SPFlight.isEnabled(467)&&o._Browser.IE!==o._BrowserDetection.getBrowserInformation().browser&&(c.e._isInteractionRequired(t.message,t.errorCode)||this._isUserLoginError(t))){var u=new Date,f=1,p=!1;if(d.e.isRemoveDuplicateHandleAuthErrorsCallEnabled())(f=this._getNumberOfAttemptsInLastMinute()+1)>1&&(p=!0);else{var m=window.sessionStorage.getItem("msalRedirectFirstAttempTime");if(m){var _=new Date(m);if(u.getTime()-_.getTime()<6e4){var h=window.sessionStorage.getItem("msalRedirectAttempNumber");h&&(f=parseInt(h,10),f++,p=!0)}}}if(p||window.sessionStorage.setItem("msalRedirectFirstAttempTime",u.toString()),f<this._allowedRedirectAttempts){e.writeExpectedFailure(t.errorCode,t,n),window.sessionStorage.setItem("msalRedirectAttempNumber",f.toString()),window.sessionStorage.setItem("msalRedirectClientId",this._defaultConfiguration.servicePrincipalId);var b=function(e){return i._redirectCancelled=!1,o._SPEventManager.instance.raiseEvent(r.n._onBeforeRedirectEventId,new r.e(e,i._cancelRedirect.bind(i))),"true"===window.sessionStorage.getItem("_isRunningTABTest")&&(i._redirectCancelled=!0),!i._redirectCancelled},g={authority:this._defaultConfiguration.aadInstanceUrl+"/"+this._defaultConfiguration.aadTenantId,correlationId:n.CorrelationId,scopes:[a+"/.default"],state:window.location.href,onRedirectNavigate:b};if(d.e.isBlockLoginHintForGuestsEnabled()&&!this._defaultConfiguration.userPrincipalName||(g.loginHint=this._defaultConfiguration.userPrincipalName),!d.e.isBlockLoginHintForGuestsEnabled()||this._defaultConfiguration.userPrincipalName||this._msalInstance.getAccount())this._msalInstance.acquireTokenRedirect(g);else{var v={authority:this._defaultConfiguration.aadInstanceUrl+"/"+this._defaultConfiguration.aadTenantId,correlationId:n.CorrelationId,scopes:[a+"/.default"],redirectUri:this._defaultConfiguration.redirectUri,state:window.location.href};d.e.isRedirectPreventionOnTokenFetchFailureEnabled()&&(v.onRedirectNavigate=b),this._msalInstance.loginRedirect(v)}}else this._writeUnexpectedFailure(e,t.errorCode,t,n)}else c.e._doesAadErrorCodeExist(t.message,s.e.EXPECTED_AAD_ERRORS)||l.indexOf("TabStop/1.0")>-1?e.writeExpectedFailure(t.errorCode,t,n):this._writeUnexpectedFailure(e,t.errorCode,t,n);throw t},e.prototype._isUserLoginError=function(e){return!!d.e.isCheckClientAuthErrorsEnabled()&&"user_login_error"===e.errorCode},e.prototype._isExpectedFailure=function(e){var t=c.e._doesAadErrorCodeExist(e.message,s.e.EXPECTED_AAD_ERRORS),n=(o._BrowserDetection.getBrowserInformation().userAgent||"").indexOf("TabStop/1.0")>-1,a=this._isUserLoginError(e),i=c.e._isInteractionRequired(e.message,e.errorCode),r=this._getNumberOfAttemptsInLastMinute()<this._allowedRedirectAttempts;return t||n||(a||i)&&r},e.prototype._getNumberOfAttemptsInLastMinute=function(){var e=0,t=window.sessionStorage.getItem("msalRedirectFirstAttempTime");if(t){var n=new Date,a=new Date(t);if(n.getTime()-a.getTime()<6e4){var i=window.sessionStorage.getItem("msalRedirectAttempNumber")||"0";e=parseInt(i,10)}}return e},e.prototype._msalLoggerCallback=function(e,t,n){console.log("[sp-http][msal.js]: "+t)},e.prototype._shouldPrintMsalLogsToConsole=function(){var e,t="msalLogging",n=(null===(e=new URLSearchParams(window.location.search).get(t))||void 0===e?void 0:e.toLowerCase())||"";"true"===n?window.sessionStorage.setItem(t,"true"):"false"===n&&window.sessionStorage.removeItem(t);var a=window.sessionStorage.getItem(t)||"";return"true"===n||"true"===a},e.prototype._writeUnexpectedFailure=function(e,t,n,a){d.e.isRemoveIEUnexpectedErrorsEnabled()&&o._BrowserDetection.getBrowserInformation().browser===o._Browser.IE?null==e||e.writeExpectedFailure(t,n,a):null==e||e.writeUnexpectedFailure(t,n,a)},e}()},nUPw:function(e,t,n){"use strict";n.d(t,"e",function(){return s});var a=n("jtSf"),i=n("MGiw"),r=n("UWqr"),o=n("NJ9J"),s=function(){function e(){}return e._handleInteractionRequiredFailures=function(t,n,s){e._doesAadErrorCodeExist(n,i.e.UNRESOLVABLE_AAD_ERROR_CODES)||i.e.RESOLVABLE_ERROR_CODES.forEach(function(e){if(n.indexOf(e)>-1){var i=t._getNavigateUrl(t.RESPONSE_TYPE.TOKEN,s)+"&prompt=select_account";r._SPEventManager.instance.raiseEvent(a.n._tokenAcquisitionEventId,new a.t(o.e,i))}})},e._isInteractionRequired=function(t,n){return!e._doesAadErrorCodeExist(t,i.e.UNRESOLVABLE_AAD_ERROR_CODES)&&i.e.RESOLVABLE_ERROR_CODES.has(n)},e._isTokenRenewalTimeout=function(e){return e===i.e.TOKEN_RENEWAL_TIMEOUT},e._isEndpointsResolutionError=function(e){return e===i.e.ENDPOINTS_RESOLUTION_ERROR},e._doesAadErrorCodeExist=function(e,t){for(var n=0,a=e.match(/(AADSTS)[0-9]+/g)||[];n<a.length;n++){var i=a[n];if(t.has(i))return!0}return!1},e}()}}]);